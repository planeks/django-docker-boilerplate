# Fail2Ban filter for Caddy script/exploit scanning attempts
# Blocks requests to common vulnerability paths and script files (JSON logs)

[Definition]

# Match attempts to access common exploit paths in Caddy JSON logs
failregex = .*"remote_ip":"<HOST>".*"uri":"[^"]*(\\.php|\\.asp|\\.aspx|\\.cgi|\\.pl|\\.py|\\.sh|\\.exe|\\.dll|\\.bat|\\.cmd|\\.com|\\.scr|\\.vbs|\\.ws|\\.wsf|/phpmyadmin|/pma|/myadmin|/mysql|/db|/database|/wp-admin|/wp-login|/xmlrpc|/config|/setup|/install|/admin\\.php|/login\\.php|/phpinfo|/shell|/backdoor|/eval-stdin\\.php|/c99\\.php|/r57\\.php|/webshell|\\.env|\\.git/|\\.svn/|\\.hg/|\\.bzr/)[^"]*".*"status":\s*(404|403).*

ignoreregex =
